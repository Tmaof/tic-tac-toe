## é—¯å…³è¦æ±‚

### ç¬¬ä¸€å…³

ä¸‹æ£‹æ¸¸æˆ
å®ç°ä¸€ä¸ªåŸºæœ¬çš„äº•å­—æ£‹æ¸¸æˆï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

1. æ¸¸æˆå¯é…ç½®ï¼Œå¯ä»¥åˆ‡æ¢ä¸ºäº”å­æ£‹ï¼ˆ5å­ï¼‰ï¼Œå¹¶ä¸”æ£‹å­æ ·å¼è¦ä»"â—‹"ã€"X"å˜ä¸ºäº”å­æ£‹çš„é»‘ç™½æ£‹å­
2. è®°å½•æ¯ä¸€æ­¥çš„æ‰§è¡Œï¼Œå¯ä»¥å›é€€åˆ°ä»»æ„ä¸€æ­¥
3. åˆç†æ‹†åˆ†ç»„ä»¶
4. ä½¿ç”¨é¡¹ç›®ç»Ÿä¸€ Eslint è§„åˆ™ï¼ˆnpm å…¨å±€å®‰è£… ezeslint åŒ…ï¼Œç„¶ååœ¨é¡¹ç›®ç›®å½•ä¸‹ç›´æ¥æ‰§è¡Œ ezeslint ï¼Œé€‰æ‹©å¯¹åº”é€‰é¡¹å³å¯ï¼‰ï¼Œä¸”æäº¤çš„ä»£ç ä¸å…è®¸å‡ºç° Lint è§„åˆ™æŠ¥é”™ï¼ˆå«è­¦å‘Šï¼‰æˆ–è€… TS æ£€æŸ¥æŠ¥é”™
5. ä½¿ç”¨ typescriptï¼Œå°½é‡ä¸ä½¿ç”¨ any
6. ä½¿ç”¨ hooks
7. å®Œæˆä¹‹åï¼Œä»£ç ä¸Šä¼ åˆ° githubï¼Œä»“åº“åä¸º tic-tac-toe, åˆ†æ”¯åä¸º master
8. æäº¤å®Œæˆåï¼Œç‚¹å‡»æŒ‰é’®è¿›å…¥ä¸‹ä¸€ç¯èŠ‚
9. é™åˆ¶æœ€é•¿å¼€å‘æ—¶é—´ï¼š2 å¤©ï¼ˆè¶Šæ—©æäº¤è¶Šå¥½å“¦~ï¼‰

å¯å‚è€ƒ [https://react.dev/learn/tutorial-tic-tac-toe](https://react.dev/learn/tutorial-tic-tac-toe)
ï¼ˆæ ·å¼ç­‰å¯ä»¥è‡ªç”±å‘æŒ¥ï¼Œåªè¦ç¬¦åˆé¢˜ç›®è¦æ±‚å³å¯~ï¼‰
æ³¨æ„ï¼š
ä»£ç è§„èŒƒæ»¡è¶³ eslint è§„åˆ™ï¼Œå…¶ä¸­æœ‰ç–‘é—®çš„å¯ä»¥å‚è€ƒ[è¿™ç¯‡æ–‡æ¡£](https://aiyongtech.feishu.cn/wiki/WyYTwn5KTiTxHwk5WbzcrQacnXh)
ä»£ç æäº¤è§„èŒƒéœ€è¦éµå¾ª[è¿™ç¯‡æ–‡æ¡£](https://aiyongtech.feishu.cn/wiki/IG4qwfJfYice2RkVH9GcZduHnxd)

### ç¬¬äºŒå…³

? æ­å–œä½ å®Œæˆç¬¬ä¸€å…³çš„æŒ‘æˆ˜~
æ„Ÿè§‰æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å°½åœ¨æŒæ¡ä¹‹ä¸­ï¼Ÿé‚£æˆ‘ä»¬å¼€å§‹æ¥ä¸‹æ¥çš„é—¯å…³å§
åœ¨ç¬¬ä¸€å…³çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå¯å˜æ£‹ç›˜çš„å°æ¸¸æˆï¼Œå¹¶ä¸”æ”¯æŒäº†äº•å­—æ£‹å’Œäº”å­æ£‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦ç»§ç»­åœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š

1. æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½¿ç”¨ Class ç»„ä»¶é‡æ„å½“å‰åº”ç”¨ã€‚æ–°å»ºçš„åˆ†æ”¯åä¸º classã€‚ï¼ˆå…¶ä»–è¦æ±‚ä¿æŒä¸å˜ï¼‰-çœ‹ä¸åˆ°å‰é¢çš„æµç¨‹äº†
2. åˆ†åˆ«åœ¨ hooks å’Œ class çš„å®ç°æ–¹å¼ä¸­ï¼Œä½¿ç”¨ [react-redux](https://react-redux.js.org/)æ¥ç®¡ç†æ•°æ®ã€‚ç®¡ç†çš„æ•°æ®å¯ä»¥åŒ…å«æ‰€æœ‰æ•°æ®ï¼Œæœ€ä½è¦æ±‚è¦åŒ…å«"å†å²è®°å½•"çš„æ•°æ®
3. æœ€æ™š2ä¸ªå·¥ä½œæ—¥å®Œæˆ

### ç¬¬ä¸‰å…³

å‰å®³å‰å®³ï¼Œåˆé—¯è¿‡ä¸€å…³?
è¿™æ¬¡å¯æ²¡é‚£ä¹ˆç®€å•å’¯ï¼Œè¯·æ¥æ‹›ï¼š
åœ¨ç°æœ‰çš„åŸºç¡€ä¸Šï¼Œå¢åŠ å’Œç©å®¶å¯¹æŠ—çš„AIï¼ˆä»…å®ç°äº•å­—æ£‹å³å¯ï¼‰ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

1. AI å¦‚æœå…ˆæ‰‹ï¼Œåˆ™éœ€è¦å°½å¯èƒ½èµ¢ï¼Œä¸èƒ½è¾“
2. AI å¦‚æœåæ‰‹ï¼Œåˆ™éœ€è¦ä¿è¯ä¸è¾“ ï¼Œå¹¶ä¸”åœ¨å¯èƒ½çš„æƒ…å†µä¸‹èµ¢
3. åœ¨åŸæœ¬çš„ class ç»„ä»¶åˆ†æ”¯å®ç°å³å¯
4. æœ€é•¿å¼€å‘æ—¶é—´ï¼š2å¤©

è¿™æ¬¡çš„é¢˜ç›®æ˜¯ä¸æ˜¯æ›´æœ‰æ„æ€äº†ï¼Ÿæ³¨æ„å®¡æ¸…é¢˜æ„ä»¥åŠåšå¥½æµ‹è¯•å“¦ï¼Œé˜²æ­¢æäº¤çš„ AI æ˜¯ä¸ª"æ™ºéšœ"~

### ç¬¬å››å…³

### ç¬¬äº”å…³

### ç¬¬å…­å…³

## æ”¹è¿›ä¼˜åŒ–è®°å½•

### ä¼˜åŒ– 1ï¼š

#### å¯¹ç»„ä»¶æ›´é«˜çš„æŠ½è±¡ï¼Œæé«˜ç»„ä»¶çš„å¯å¤ç”¨å¯æ‹“å±•æ€§ï¼Œç†è§£æ•°æ®é©±åŠ¨è§†å›¾ï¼ˆé…ç½®å¯¹è±¡åˆ—è¡¨ï¼‰

#### å‡å°‘ä¸å¿…è¦çš„ div

#### ä¼˜åŒ–è®¡ç®—èƒœåˆ©è€…çš„é€»è¾‘ï¼Œä½¿å…¶æ›´å…·é€šç”¨æ€§

#### å‡å°‘ä¸å¿…è¦çš„ useMemo

#### å¦‚æœä¸ç¬¦åˆæ¡ä»¶ç›´æ¥è¿”å›ï¼Œå‡å°‘ä¸å¿…è¦çš„ if-else

#### ä»”ç»†æµ‹è¯•ä»£ç ï¼Œå‡å°‘ bug

### ä¼˜åŒ– 2ï¼š

#### å‡å°‘ä¸å¿…è¦çš„æ•°æ®æ´¾ç”Ÿæ“ä½œï¼Œæƒ³æ¸…æ¥šæ˜¯å¦å¯ä»¥ç›´æ¥åˆ©ç”¨å½“å‰æ•°æ®

oldï¼š

```tsx
/** ç”¨äºæ¸²æŸ“çš„æ¨¡å¼é€‰æ‹©åˆ—è¡¨ */
const selectList = configList.map((config, index) => {
  return {
    name: config.name,
    configIndex: index,
  };
});

// selectList.map(({ name, configIndex }) => {
```

newï¼š

```tsx
configList.map((config, index) => {
```

#### å½“ä¸€ä¸ªç”Ÿæˆå¯¹è±¡çš„å‡½æ•°å‚æ•°å¤ªå¤šï¼Œä¸å¦‚ç›´æ¥å†™å¯¹è±¡ï¼š

oldï¼š

```tsx

/**
 * åˆ›å»ºæ¸¸æˆé…ç½®å¯¹è±¡
 *
 * @param name æ¸¸æˆåç§°
 * @param playerFlags ä¸åŒæ£‹æ‰‹çš„æ£‹å­æ ·å¼ï¼Œæ”¯æŒä¸¤ä¸ªä»¥ä¸Šçš„å¤šç©å®¶
 * @param rowNum æ£‹ç›˜çš„è¡Œæ•°
 * @param colNum æ£‹ç›˜çš„åˆ—æ•°
 * @param successNeedNum è¦æ±‚è·èƒœæ—¶åœ¨ä¸€æ¡çº¿ä¸Šçš„æœ€å°‘æ£‹å­æ•°é‡
 * @returns è¿”å›æ¸¸æˆé…ç½®å¯¹è±¡
 */
const createGameConfig = function createGameConfig (name: GameConfig['name'], playerFlags:ChessProps['playerFlags'], rowNum:ChessProps['rowNum'], colNum:ChessProps['colNum'], successNeedNum:ChessProps['successNeedNum']): GameConfig {
    return {
        name,
        ChessProps: {
            playerFlags,
            rowNum,
            colNum,
            successNeedNum,
        },
    };
};

/**
 * è·å–æ¸¸æˆé…ç½®åˆ—è¡¨
 */
export const getGameConfigList = function getGameConfigList (): GameConfig[] {
    return [
        createGameConfig('äº•å­—æ£‹', ['âŒ', 'ğŸ”˜'], 3, 3,  3),
        createGameConfig('äº”å­æ£‹ï¼ˆ15*15ï¼‰', ['âš«', 'âšª'], 15, 15,  5),
        createGameConfig('äº”å­æ£‹ï¼ˆ15*25ï¼‰', ['âš«', 'âšª'], 15, 25,  5),
        createGameConfig('ä¸ƒå­æ£‹ï¼ˆ3ä¸ªç©å®¶ï¼‰', ['ğŸŸ¢', 'ğŸŸ£', 'ğŸ”µ'], 20, 20,  7),
    ];
};
```

newï¼š

```tsx

/**
 * è·å–æ¸¸æˆé…ç½®åˆ—è¡¨
 */
export const getGameConfigList = function getGameConfigList (): GameConfig[] {
    return [
        { name: 'äº•å­—æ£‹', ChessProps: { playerFlags: ['âŒ', 'ğŸ”˜'], rowNum: 3, colNum: 3, successNeedNum: 3 } },
        { name: 'äº”å­æ£‹ï¼ˆ15*15ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 15, successNeedNum: 5 } },
        { name: 'äº”å­æ£‹ï¼ˆ15*25ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 25, successNeedNum: 5 } },
        { name: 'ä¸ƒå­æ£‹ï¼ˆ3ä¸ªç©å®¶ï¼‰', ChessProps: { playerFlags: ['ğŸŸ¢', 'ğŸŸ£', 'ğŸ”µ'], rowNum: 20, colNum: 20, successNeedNum: 7 } },
    ];
};

```

#### å°†å¤šå±æ€§çš„æ•°æ®æŠ½è±¡ä¸ºå¯¹è±¡ï¼Œå¹¶ä¸ºå¯¹è±¡æä¾›å”¯ä¸€æ ‡è¯†

```tsx
/**
 * è·å–æ¸¸æˆé…ç½®åˆ—è¡¨
 */
export const getGameConfigList = function getGameConfigList (): GameConfig[] {
    return [
        { id: 1, name: 'äº•å­—æ£‹', ChessProps: { playerFlags: ['âŒ', 'ğŸ”˜'], rowNum: 3, colNum: 3, successNeedNum: 3 } },
        { id: 2, name: 'äº”å­æ£‹ï¼ˆ15*15ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 15, successNeedNum: 5 } },
        { id: 3, name: 'äº”å­æ£‹ï¼ˆ15*25ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 25, successNeedNum: 5 } },
        { id: 4, name: 'ä¸ƒå­æ£‹ï¼ˆ3ä¸ªç©å®¶ï¼‰', ChessProps: { playerFlags: ['ğŸŸ¢', 'ğŸŸ£', 'ğŸ”µ'], rowNum: 20, colNum: 20, successNeedNum: 7 } },
    ];
};
```

```tsx
            {/* æ¸¸æˆè§†å›¾åŒºåŸŸï¼Œæ ¹æ®æ¨¡å¼æ˜¾ç¤ºä¸åŒçš„æ¸¸æˆç»„ä»¶ */}
            <div className='game-view'>
                {
                    configList.map((config) => {
                        return (currentModeId === config.id) && <Chess key={config.id} {...config.ChessProps} ></Chess>;
                    })
                }
            </div>
```

#### å°†æ£‹æ‰‹å’Œä»–ä½¿ç”¨çš„æ£‹å­æŠ½è±¡ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ç»™ä¸€ä¸ª ID

å¯èƒ½çš„ä¾‹å­ï¼š

```tsx
/** ç©å®¶ä¿¡æ¯ */
export type PlayerInfo = {
    /** æ£‹å­çš„æ ·å¼ */
    flag: string;
    /** ç©å®¶çš„åå­— */
    name: string;
    /** ç©å®¶çš„id */
    id: number;
}


/** æ£‹ç±»ç»„ä»¶çš„Propsçš„ç±»å‹ */
export type ChessProps = {
    /** ä¸åŒæ£‹æ‰‹çš„æ£‹å­æ ·å¼ï¼Œæ”¯æŒä¸¤ä¸ªä»¥ä¸Šçš„å¤šç©å®¶ */
    playerFlags: PlayerInfo[];
    /** æ£‹ç›˜çš„è¡Œæ•° */
    rowNum: number;
    /** æ£‹ç›˜çš„åˆ—æ•° */
    colNum: number;
    /** è¦æ±‚è·èƒœæ—¶åœ¨ä¸€æ¡çº¿ä¸Šçš„æœ€å°‘æ£‹å­æ•°é‡ */
    successNeedNum: number;
}
```

#### å‡½æ•°çš„å£°æ˜æ–¹å¼ï¼Œå°½é‡ä½¿ç”¨ç®­å¤´å‡½æ•°çš„å½¢å¼ï¼Œæ™®é€šå‡½æ•°æœ‰åŠ¨æ€ this çš„é—®é¢˜ï¼Œæ³¨æ„åŒ¿åå‡½æ•°å¯¹è°ƒè¯•çš„å½±å“ï¼Ÿ

oldï¼š

```tsx
/**
 * è·å–æ¸¸æˆé…ç½®åˆ—è¡¨
 */
export const getGameConfigList = function getGameConfigList (): GameConfig[] {
    return [
        { id: 1, name: 'äº•å­—æ£‹', ChessProps: { playerFlags: ['âŒ', 'ğŸ”˜'], rowNum: 3, colNum: 3, successNeedNum: 3 } },
        { id: 2, name: 'äº”å­æ£‹ï¼ˆ15*15ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 15, successNeedNum: 5 } },
        { id: 3, name: 'äº”å­æ£‹ï¼ˆ15*25ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 25, successNeedNum: 5 } },
        { id: 4, name: 'ä¸ƒå­æ£‹ï¼ˆ3ä¸ªç©å®¶ï¼‰', ChessProps: { playerFlags: ['ğŸŸ¢', 'ğŸŸ£', 'ğŸ”µ'], rowNum: 20, colNum: 20, successNeedNum: 7 } },
    ];
};

```

newï¼š

```tsx
/**
 * è·å–æ¸¸æˆé…ç½®åˆ—è¡¨
 */
export const getGameConfigList = (): GameConfig[] => {
    return [
        { id: 1, name: 'äº•å­—æ£‹', ChessProps: { playerFlags: ['âŒ', 'ğŸ”˜'], rowNum: 3, colNum: 3, successNeedNum: 3 } },
        { id: 2, name: 'äº”å­æ£‹ï¼ˆ15*15ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 15, successNeedNum: 5 } },
        { id: 3, name: 'äº”å­æ£‹ï¼ˆ15*25ï¼‰', ChessProps: { playerFlags: ['âš«', 'âšª'], rowNum: 15, colNum: 25, successNeedNum: 5 } },
        { id: 4, name: 'ä¸ƒå­æ£‹ï¼ˆ3ä¸ªç©å®¶ï¼‰', ChessProps: { playerFlags: ['ğŸŸ¢', 'ğŸŸ£', 'ğŸ”µ'], rowNum: 20, colNum: 20, successNeedNum: 7 } },
    ];
};

```

å‡½æ•°çš„ nameï¼š

```tsx
const myFn = () => {
  console.log('hello world')
}
// myFn
console.log(myFn.name)

const myFn2 = function () {
  console.log('hello world')
}
// myFn2
console.log(myFn2.name)

const myFn3 = function test() {
  console.log('hello world')
}
// test
console.log(myFn3.name)

```

#### ä½¿ç”¨`.d.ts`æ–‡ä»¶å£°æ˜ç±»å‹ï¼Œeslint ä¸æ£€æŸ¥ï¼Ÿ

```tsx
// src\components\Board\Board.type.ts
import { PosInfo } from '../../utils/index.type';

/** æ£‹ç›˜äºŒç»´åˆ—è¡¨ï¼Œå…¶ä¸­ï¼šå­—ç¬¦ä¸²è¡¨ç¤ºæ£‹å­ï¼Œæˆ–nullè¡¨ç¤ºç©º */
export type SquaresList = ((string | null)[])[]
```

```tsx
src\components\Board\test.d.ts
import { SquaresList } from './Board.type';
// è¿è¡Œnpm run lint å‘½ä»¤æŠ¥é”™äº†
```

è¿è¡Œnpm run lint å‘½ä»¤æŠ¥é”™äº†ï¼š

```tsx
> tic-tac-toe@0.0.0 lint
> eslint . --fix --ext ts,tsx,cjs --report-unused-disable-directives --max-warnings 0


D:\Code\mycode\tic-tac-toe\src\components\Board\test.d.ts
  1:10  error  'SquaresList' is defined but never used  @typescript-eslint/no-unused-vars

âœ– 1 problem (1 error, 0 warnings)
```

> å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼Ÿåœ¨`.d.ts`æ–‡ä»¶ä¸­ä½¿ç”¨äº†ä¸€ä¸ªå¤–éƒ¨çš„ç±»å‹ï¼Œä½†æˆ‘ä»¬å¹¶æ²¡æœ‰å¼•å…¥è¯¥ç±»å‹ï¼Œ eslint ä¸ä¼šæŠ¥é”™æç¤ºï¼š

åœ¨ä¸‹é¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æœªå¼•å…¥çš„`PlayerInfo`ï¼š

```tsx
// src\store\modules\game\actions.type.d.ts

export type GameConfig = {
    id: number;
    name: string;
    ChessProps: {
        playerInfoList: PlayerInfo[];
        rowNum: number;
        colNum: number;
        successNeedNum: number;
    };
};
```

![image.png](https://cdn.nlark.com/yuque/0/2024/png/34576819/1720663238626-b855e27c-4951-4c7d-b224-c0bfb3c78719.png#averageHue=%23fdfbfb&clientId=u9afbce02-ae85-4&from=paste&height=486&id=u1f27d28d&originHeight=486&originWidth=1266&originalType=binary&ratio=1&rotation=0&showTitle=false&size=61606&status=done&style=none&taskId=ud82a3cc3-d12c-4979-ac05-0a1e392115e&title=&width=1266)
ä»ä¸€ä¸ªé”™è¯¯è·¯å¾„å¼•å…¥ç±»å‹ä¹Ÿä¸ä¼šæŠ¥é”™ï¼š
![image.png](https://cdn.nlark.com/yuque/0/2024/png/34576819/1720663677389-a09fcb21-c75d-490f-8340-25c56fff46e1.png#averageHue=%23fdfbfb&clientId=u9afbce02-ae85-4&from=paste&height=480&id=u90e8dea4&originHeight=480&originWidth=1106&originalType=binary&ratio=1&rotation=0&showTitle=false&size=61946&status=done&style=none&taskId=u59cb9ffb-0d33-4982-9ae0-41759d696b2&title=&width=1106)
ä½¿ç”¨`.ts`æ–‡ä»¶æ—¶ï¼Œeslint ä¼šæç¤ºï¼šæ‰¾ä¸åˆ°åç§°â€œPlayerInfoâ€ã€‚ts(2304)
![image.png](https://cdn.nlark.com/yuque/0/2024/png/34576819/1720663367905-ca488d75-9207-460b-8e06-c3563e418ef6.png#averageHue=%23fbfafa&clientId=u9afbce02-ae85-4&from=paste&height=452&id=ubb35efc6&originHeight=452&originWidth=1217&originalType=binary&ratio=1&rotation=0&showTitle=false&size=62726&status=done&style=none&taskId=ua148303b-f625-4d91-bf94-61361c42dcf&title=&width=1217)

#### å‡å°‘ let å£°æ˜å˜é‡ï¼Œä¹‹åèµ‹å€¼çš„æƒ…å†µ

oldï¼š

```tsx
    /** è®¡ç®—æ—¶é—´æ—…è¡Œçš„æ¯ä¸€é¡¹å…ƒç´  */
    const timeTravelItemList = useMemo(() => {
        return historyList.map((_history, index) => {
            let description;
            if (index > 0) {
                description = `å›åˆ°çŠ¶æ€ #${index}`;
            } else {
                description = 'å›åˆ°æ¸¸æˆå¼€å§‹';
            }
            return (
                <li key={index}>
                    <button onClick={() => handleTimeTrave(index)}>{description}</button>
                </li>
            );
        });
    }, [historyList]);
```

newï¼š

```tsx
    /** è®¡ç®—æ—¶é—´æ—…è¡Œçš„æ¯ä¸€é¡¹å…ƒç´  */
    const timeTravelItemList = useMemo(() => {
        return historyList.map((_history, index) => {
            const description = index > 0 ? `å›åˆ°çŠ¶æ€ #${index}` : 'å›åˆ°æ¸¸æˆå¼€å§‹';
            return (
                <li key={index}>
                    <button onClick={() => handleTimeTrave(index)}>{description}</button>
                </li>
            );
        });
    }, [historyList]);
```

oldï¼š

```tsx
  /**
     * å¤„ç†ä¸‹æ£‹çš„å‡½æ•°
     * @param {SquaresList} nextSquares - æ›´æ–°åçš„æ£‹ç›˜çŠ¶æ€
     */
    const handlePlay =  (nextSquares: SquaresList, posX:number, posY:number) => {
        if (currentHistory.gameOver) {
            window.confirm('æ¸¸æˆå·²ç»ç»“æŸäº†ï¼');
            return;
        }
        // ä¸‹å®Œä¸€æ£‹åéœ€è¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨èƒœåˆ©è€…
        const calculateRes = calculateWinner(nextSquares, props.successNeedNum, posX, posY);
        let onLinePointPosList;
        let gameOver = false;
        if (calculateRes) {
            // å­˜åœ¨èƒœåˆ©è€…ï¼Œæ¸¸æˆç»“æŸ
            const { winner, onLinePointPosList: list } = calculateRes;
            onLinePointPosList = list;
            gameOver = true;
            window.confirm(`æ£‹æ‰‹${winner}èƒœåˆ©äº†ï¼`);
        }
        /** æ–°çš„ä¸‹ä¸€ä¸ªæ£‹æ‰‹çš„æ£‹å­çš„ç´¢å¼• */
        const nextPlayerIndex = (currentHistory.nextPlayerIndex + 1) % props.playerFlags.length;
        /** æ–°çš„å†å²è®°å½•å¯¹è±¡ */
        const newHistory:HistoryObj = { squares: nextSquares, nextPlayerIndex, onLinePointPosList, gameOver };
        // å°†æ–°çš„å†å²çŠ¶æ€æ·»åŠ åˆ°å†å²åˆ—è¡¨
        const newHistoryList = [...historyList.slice(0, currentMove + 1), newHistory];
        setHistoryList(newHistoryList);
        // æ›´æ–°æ£‹ç›˜è®°å½•çš„ä½ç½®ï¼šæ›´æ–°currentMoveåcurrentHistoryä¼šè‡ªåŠ¨æ›´æ–°
        setCurrentMove(newHistoryList.length - 1);
    };
```

newï¼š

```tsx
éœ€è¦ä¿®æ”¹calculateWinneræ–¹æ³•ï¼Œä½¿å…¶è¿”å›çš„æ•°æ®ç»“æ„ï¼Œç±»å‹ä¸€è‡´ï¼Œè¿™æ ·å°±ä¸ç”¨å†åˆ¤æ–­  if (calculateRes) {}ï¼Œä¹Ÿä¸ç”¨å£°æ˜
let onLinePointPosList;
let gameOver = false;
```

#### å‡½æ•°è¿”å›çš„æ•°æ®ç»“æ„å°½é‡ä¸€è‡´

oldï¼š

```tsx
/**
 * è®¡ç®—èƒœåˆ©è€…ã€‚
 * æ£€æŸ¥åœ¨posYå’ŒposXä½ç½®çš„æ£‹å­å‘¨å›´çš„æ‰€æœ‰å¯èƒ½æ–¹å‘ä¸Šæ˜¯å¦æœ‰è¿ç»­çš„successNeedNumä¸ªç›¸åŒçš„æ£‹å­åœ¨åŒä¸€ç›´çº¿ä¸Šã€‚
 * è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å››ä¸ªæ–¹å‘ï¼šæ°´å¹³ã€å‚ç›´ã€æ­£å¯¹è§’çº¿å’Œåå¯¹è§’çº¿ã€‚
 *
 * @param squares æ£‹ç›˜äºŒç»´æ•°ç»„
 * @param successNeedNum è¦æ±‚è·èƒœæ—¶åœ¨ä¸€æ¡çº¿ä¸Šçš„æœ€å°‘æ£‹å­æ•°é‡
 * @param posX æ£‹å­æ¨ªåæ ‡(åˆ—ä½ç½®)
 * @param posY æ£‹å­çºµåæ ‡(è¡Œä½ç½®)
 * @returns è·èƒœè€…çš„æ ‡è®°ï¼ˆå­—ç¬¦ä¸²ï¼‰å’Œåœ¨åŒä¸€æ¡çº¿ä¸Šçš„ç‚¹çš„åæ ‡
 */
export const calculateWinner = (squares: SquaresList, successNeedNum: number, posX: number, posY: number) => {
    /** ä¿å­˜æœ‰ç©å®¶èƒœåˆ©æ—¶ï¼Œåœ¨åŒä¸€æ¡çº¿ä¸Šçš„ç‚¹çš„åæ ‡ */
    let onLinePointPosList:PosInfo[] = [];

  ã€‚ã€‚ã€‚
  
    // æ£€æŸ¥æ‰€æœ‰æ–¹å‘ï¼šè°ƒç”¨checkDirectionå››æ¬¡ï¼Œåˆ†åˆ«æ£€æŸ¥æ°´å¹³ã€å‚ç›´ã€æ­£å¯¹è§’çº¿å’Œåå¯¹è§’çº¿æ–¹å‘ã€‚
    if (checkDirection(1, 0) || checkDirection(0, 1) || checkDirection(1, 1) || checkDirection(-1, 1)) {
        return {
            winner: squares[posY][posX],
            onLinePointPosList,
        };
    }

    return null; // å¦‚æœæ²¡æœ‰è·èƒœè€…
};
```

newï¼š

```tsx
/**
 * è®¡ç®—èƒœåˆ©è€…ã€‚
 * æ£€æŸ¥åœ¨posYå’ŒposXä½ç½®çš„æ£‹å­å‘¨å›´çš„æ‰€æœ‰å¯èƒ½æ–¹å‘ä¸Šæ˜¯å¦æœ‰è¿ç»­çš„successNeedNumä¸ªç›¸åŒçš„æ£‹å­åœ¨åŒä¸€ç›´çº¿ä¸Šã€‚
 * è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å››ä¸ªæ–¹å‘ï¼šæ°´å¹³ã€å‚ç›´ã€æ­£å¯¹è§’çº¿å’Œåå¯¹è§’çº¿ã€‚
 *
 * @param squares æ£‹ç›˜äºŒç»´æ•°ç»„
 * @param successNeedNum è¦æ±‚è·èƒœæ—¶åœ¨ä¸€æ¡çº¿ä¸Šçš„æœ€å°‘æ£‹å­æ•°é‡
 * @param posX æ£‹å­æ¨ªåæ ‡(åˆ—ä½ç½®)
 * @param posY æ£‹å­çºµåæ ‡(è¡Œä½ç½®)
 * @returns è·èƒœè€…çš„æ ‡è®°ï¼ˆå­—ç¬¦ä¸²ï¼‰å’Œåœ¨åŒä¸€æ¡çº¿ä¸Šçš„ç‚¹çš„åæ ‡
 */
export const calculateWinner = (squares: SquaresList, successNeedNum: number, posX: number, posY: number) => {
    /** ä¿å­˜æœ‰ç©å®¶èƒœåˆ©æ—¶ï¼Œåœ¨åŒä¸€æ¡çº¿ä¸Šçš„ç‚¹çš„åæ ‡ */
    let onLinePointPosList:PosInfo[] = [];

  ã€‚ã€‚ã€‚
  
    // æ£€æŸ¥æ‰€æœ‰æ–¹å‘ï¼šè°ƒç”¨checkDirectionå››æ¬¡ï¼Œåˆ†åˆ«æ£€æŸ¥æ°´å¹³ã€å‚ç›´ã€æ­£å¯¹è§’çº¿å’Œåå¯¹è§’çº¿æ–¹å‘ã€‚
    if (checkDirection(1, 0) || checkDirection(0, 1) || checkDirection(1, 1) || checkDirection(-1, 1)) {
        return {
            winner: squares[posY][posX],
            onLinePointPosList,
        };
    }

    // å¦‚æœæ²¡æœ‰è·èƒœè€…
    return {
        winner: null,
        onLinePointPosList: [],
    };
};
```

è¿™æ ·æˆ‘ä»¬çš„`handlePlay`å‡½æ•°å°±ä¸å­˜åœ¨ let å£°æ˜å˜é‡ï¼Œä¹‹åèµ‹å€¼çš„é—®é¢˜äº†ï¼š

```tsx
    /**
     * å¤„ç†ä¸‹æ£‹çš„å‡½æ•°
     * @param {SquaresList} nextSquares - æ›´æ–°åçš„æ£‹ç›˜çŠ¶æ€
     */
    const handlePlay =  (nextSquares: SquaresList, posX:number, posY:number) => {
        if (currentHistory.gameOver) {
            window.confirm('æ¸¸æˆå·²ç»ç»“æŸäº†ï¼');
            return;
        }
        // ä¸‹å®Œä¸€æ£‹åéœ€è¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨èƒœåˆ©è€…
        const { winner, onLinePointPosList  } = calculateWinner(nextSquares, props.successNeedNum, posX, posY);
        if (winner) {
            // å­˜åœ¨èƒœåˆ©è€…ï¼Œæ¸¸æˆç»“æŸ
            window.confirm(`æ£‹æ‰‹${winner}èƒœåˆ©äº†ï¼`);
        }
        /** æ–°çš„ä¸‹ä¸€ä¸ªæ£‹æ‰‹çš„æ£‹å­çš„ç´¢å¼• */
        const nextPlayerIndex = (currentHistory.nextPlayerIndex + 1) % props.playerFlags.length;
        /** æ–°çš„å†å²è®°å½•å¯¹è±¡ */
        const newHistory:HistoryObj = { squares: nextSquares, nextPlayerIndex, onLinePointPosList, gameOver: winner !== null };
        // å°†æ–°çš„å†å²çŠ¶æ€æ·»åŠ åˆ°å†å²åˆ—è¡¨
        const newHistoryList = [...historyList.slice(0, currentMove + 1), newHistory];
        setHistoryList(newHistoryList);
        // æ›´æ–°æ£‹ç›˜è®°å½•çš„ä½ç½®ï¼šæ›´æ–°currentMoveåcurrentHistoryä¼šè‡ªåŠ¨æ›´æ–°
        setCurrentMove(newHistoryList.length - 1);
    };
```

### ä¼˜åŒ– 3

#### å°†è®¾ç½® redux çŠ¶æ€æå–ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯é€šè¿‡ props ä¼ é€’ dispatch å‡½æ•°

oldï¼š

```tsx
import  { PureComponent } from 'react';
import './Game.scss';
import Chess from '../Chess/Chess';
import { getGameConfigListAPI } from '../../apis/game';
import { RootState,  } from '../../store';
import { setGameConfigList, setCurrentConfigId } from '../../store/modules/game/actions';
import { connect } from 'react-redux';


/** æ˜ å°„çŠ¶æ€åˆ°Gameç»„ä»¶çš„props */
const mapStateToProps = (state:RootState) => {
    return {
        configList: state.game.gameConfigList,
        currentConfigId: state.game.currentConfigId,
    };
};

/** æ˜ å°„dispatchåˆ°Gameç»„ä»¶çš„props */
/** åŒ…å« action creater å‡½æ•°çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜ å°„åˆ°ç»„ä»¶propså¹¶è°ƒç”¨æ—¶ä¼šè‡ªåŠ¨dispatchï¼Œå¦‚ï¼šdispatch(setGameConfigList())  */
const mapDispatchToProps = {
    setGameConfigList,
    setCurrentConfigId,
};

type GameProps = ReturnType<typeof mapStateToProps> & typeof mapDispatchToProps;


/** æ¸¸æˆç»„ä»¶å®šä¹‰ */
class Game extends PureComponent<GameProps> {
    /** ç»„ä»¶æŒ‚è½½åï¼Œè·å–æ¸¸æˆé…ç½®åˆ—è¡¨ */
    componentDidMount () {
        getGameConfigListAPI().then((configList) => {
            this.props.setGameConfigList(configList);
            this.props.setCurrentConfigId(configList[0].id);
        });
    }

    render () {
      ã€‚ã€‚ã€‚
    }
}


export default connect(mapStateToProps, mapDispatchToProps)(Game);

```

newï¼š
æŠ½ç¦»ä¸ºå¦‚ä¸‹æ–¹æ³•ï¼š

```tsx
// src\store\modules\game\utils.ts
import { store } from '../..';
import { setCurrentConfigId, setGameConfigList } from './actions';
import { GameConfig, GameConfigId } from './reducer.type';

/**
 * è®¾ç½®å½“å‰ä½¿ç”¨çš„æ¸¸æˆé…ç½®id(å³å½“å‰çš„æ£‹ç±»æ¸¸æˆ)
 * @param configId é…ç½®id
 */
export const setCurrentConfigIdUtil = (configId:GameConfigId) => {
    store.dispatch(setCurrentConfigId(configId));
};

/**
 * è®¾ç½®æ¸¸æˆçš„é…ç½®åˆ—è¡¨
 * @param gameConfigList é…ç½®åˆ—è¡¨
 */
export const setGameConfigListUtil = (gameConfigList: GameConfig[]) => {
    store.dispatch(setGameConfigList(gameConfigList));
};

```

ä½¿ç”¨ï¼š

```tsx
import  { PureComponent } from 'react';
import './Game.scss';
import Chess from '../Chess/Chess';
import { getGameConfigListAPI } from '../../apis/game';
import { RootState,  } from '../../store';
import { connect } from 'react-redux';
import { setCurrentConfigIdUtil, setGameConfigListUtil } from '../../store/modules/game/utils';


/** æ˜ å°„çŠ¶æ€åˆ°Gameç»„ä»¶çš„props */
const mapStateToProps = (state:RootState) => {
    return {
        configList: state.game.gameConfigList,
        currentConfigId: state.game.currentConfigId,
    };
};

type GameProps = ReturnType<typeof mapStateToProps>;

/** æ¸¸æˆç»„ä»¶å®šä¹‰ */
class Game extends PureComponent<GameProps> {
    /** ç»„ä»¶æŒ‚è½½åï¼Œè·å–æ¸¸æˆé…ç½®åˆ—è¡¨ */
    componentDidMount () {
        getGameConfigListAPI().then((configList) => {
            setGameConfigListUtil(configList);
            setCurrentConfigIdUtil(configList[0].id);
        });
    }

    render () {
        ã€‚ã€‚ã€‚
    }
}


export default connect(mapStateToProps)(Game);

```

#### ä¸è¦ç›´æ¥ä¿®æ”¹ state

oldï¼š

```tsx
import { GameConfigId } from '../game/reducer.type';
import { HistoryAction, HistoryActionTypesEnum } from './action.type';
import { HistoryInfo, HistoryState } from './reducer.type';

export const initState: HistoryState = new Map<GameConfigId, HistoryInfo>();

export const historyReducer = (state: HistoryState = initState, action: HistoryAction): HistoryState => {
    switch (action.type) {
        case HistoryActionTypesEnum.SET_HISTORY_LIST:
            if (state.get(action.configId) !== undefined) {
                state.set(action.configId, { ...state.get(action.configId)!, historyList: action.payload });
            } else {
                state.set(action.configId, { historyList: action.payload, currentHistoryIndex: 0 });
            }
            return new Map(state);
        case HistoryActionTypesEnum.SET_CURRENT_HISTORY_INDEX:
            if (state.get(action.configId) !== undefined) {
                state.set(action.configId, { ...state.get(action.configId)!, currentHistoryIndex: action.payload });
            }
            return new Map(state);
        case HistoryActionTypesEnum.RESET_HISTORY:
            state.delete(action.configId);
            return new Map(state);
        default:
            return state;
    }
};

```

newï¼š

```tsx
import { GameConfigId } from '../game/reducer.type';
import { HistoryAction, HistoryActionTypesEnum } from './action.type';
import { HistoryInfo, HistoryState } from './reducer.type';

export const initState: HistoryState = new Map<GameConfigId, HistoryInfo>();

export const historyReducer = (state: HistoryState = initState, action: HistoryAction): HistoryState => {
    const newMap = new Map(state);
    const historyInfo = newMap.get(action.configId);
    switch (action.type) {
        case HistoryActionTypesEnum.SET_HISTORY_LIST:
            if (historyInfo) {
                newMap.set(action.configId, { ...historyInfo, historyList: action.payload });
            } else {
                newMap.set(action.configId, { historyList: action.payload, currentHistoryIndex: 0 });
            }
            return newMap;
        case HistoryActionTypesEnum.SET_CURRENT_HISTORY_INDEX:
            if (historyInfo) {
                newMap.set(action.configId, { ...historyInfo, currentHistoryIndex: action.payload });
            }
            return newMap;
        case HistoryActionTypesEnum.RESET_HISTORY:
            newMap.delete(action.configId);
            return newMap;
        default:
            return state;
    }
};

```

#### ä½¿ç”¨ await - async

oldï¼š

```tsx

    /** ç»„ä»¶æŒ‚è½½åï¼Œè·å–æ¸¸æˆé…ç½®åˆ—è¡¨ */
    componentDidMount () {
        getGameConfigListAPI().then((configList) => {
            setGameConfigListUtil(configList);
            setCurrentConfigIdUtil(configList[0].id);
        });
    }
```

newï¼š

```tsx
    /** ç»„ä»¶æŒ‚è½½åï¼Œè·å–æ¸¸æˆé…ç½®åˆ—è¡¨ */
    async componentDidMount () {
        const configList = await getGameConfigListAPI();
        setGameConfigListUtil(configList);
        setCurrentConfigIdUtil(configList[0].id);
    }
```

### ä¼˜åŒ– 4

#### è§£å†³ bug

åœ¨ç»„ä»¶æ›´æ–°åè°ƒç”¨`aIPlaysChess`è¿›è¡Œ AI ä¸‹æ£‹å¹¶ä½¿ç”¨`setTimeout`å»¶è¿Ÿä¸‹æ£‹æ“ä½œä¼šé€ æˆ bugï¼šå¦‚æœåœ¨ setimeout çš„å›è°ƒå‡½æ•°ç­‰å¾…è§¦å‘æœŸé—´è¿›è¡Œæ—¶é—´å›æº¯ï¼Œå¯èƒ½ä¼šåœ¨æ—¶é—´å›æº¯åçš„ç©ºä½ç½®ä¸‹æ£‹ã€‚
è§£å†³ï¼šæ·»åŠ `isAIplaying`æ ‡è®°ï¼Œä¸º`true`è¡¨ç¤º AI æ­£åœ¨ä¸‹æ£‹ï¼Œä¸èƒ½è¿›è¡Œæ—¶é—´å›æº¯ã€‚

```tsx
    /**
     * AIä¸‹æ£‹
     * @param currentHistory å½“å‰æœ€æ–°çš„æ£‹ç›˜è®°å½•ï¼Œä¾‹å¦‚ç©å®¶ä¸‹å®Œæ£‹åè°ƒç”¨è¯¥æ–¹æ³•æ—¶éœ€è¦ä¼ å…¥æœ€æ–°çš„æ£‹ç›˜è®°å½•ï¼ˆä¾‹å¦‚åŒ…å«æœ€æ–°çš„æ£‹ç›˜äºŒç»´åˆ—è¡¨squaresï¼‰ï¼ŒAIæ‰èƒ½æ ¹æ®æœ€æ–°çš„æ£‹ç›˜è®°å½•è¿›è¡Œæ­£ç¡®ä¸‹æ£‹
     * @returns
     */
    handleAIPlay = (currentHistory: HistoryObj) => {
        if (!this.props.isAIMode) return;
        const { playerInfoList, successNeedNum } = this.props;
        const player = playerInfoList[currentHistory.nextPlayerIndex];
        if (!player.isAI) return;

        // è°ƒç”¨è®¡ç®—ä¸‹æ£‹ä½ç½®çš„æ–¹æ³•è·å–ä½ç½®ï¼Œå¹¶ä¸‹æ£‹
        const opponentPlayer = playerInfoList[getPlayerIndex(playerInfoList, false)];
        const { posY, posX } = calculateNextMove(currentHistory.squares, player.flag, opponentPlayer.flag, successNeedNum);
        if (posY < 0 || posX < 0) return; // æ£‹ç›˜å·²æ»¡
        this.isAIplaying = true; // è®¾ç½®AIæ­£åœ¨ä¸‹æ£‹ä¸­ï¼Œä¸èƒ½è¿›è¡Œæ—¶é—´å›æº¯
        setTimeout(() => {
            this.handlePlay({ posY, posX });
            this.isAIplaying = false; // AIä¸‹æ£‹å®Œæˆ
        }, 300);
    };
```

#### ä¸åº”è¯¥åœ¨ç»„ä»¶æ›´æ–°åè°ƒç”¨ AI ä¸‹æ£‹

oldï¼š

```tsx
    /** ç»„ä»¶æ›´æ–° */
    componentDidUpdate (): void {
        // å¦‚æœæ˜¯AIæ¨¡å¼ä¸”ä¸‹ä¸€ä½æ£‹æ‰‹æ˜¯AIï¼Œåˆ™éœ€è¦AIä¸‹æ£‹
        this.aIPlaysChess();
    }
```

newï¼š
åœ¨ç©å®¶ä¸‹æ£‹åå†è¿›è¡Œ AI ä¸‹æ£‹ã€‚

```tsx
    /**
     * å¤„ç†ç©å®¶ç‚¹å‡»ä¸‹æ£‹çš„å‡½æ•°
     * @param pos å½“å‰æ£‹å­çš„ä½ç½®
     * @returns
     */
    handlePlayerPlay = (pos: PosInfo) => {
        const { playerInfoList } = this.props;
        const { currentHistory } = this.state;
        const player = playerInfoList[currentHistory.nextPlayerIndex];
        if (player.isAI) return; // å¦‚æœå½“å‰æ˜¯AIä¸‹æ£‹ï¼Œåˆ™ä¸å…è®¸ç©å®¶è¿›è¡Œä¸‹æ£‹æ“ä½œ
        // ç©å®¶ä¸‹æ£‹
        const newHistory = this.handlePlay(pos);
        // å½“ç©å®¶ä¸‹æ£‹åéœ€è¦AIç»§ç»­ä¸‹æ£‹ï¼ŒAIä¸‹æ£‹åä¸ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼ˆä¿è¯ä¸ä¼šå‘ç”Ÿæ­»å¾ªç¯ï¼‰
        if (newHistory && newHistory.status === 'playing') this.handleAIPlay(newHistory);
    };
```

#### è·å–ç©ºä½ä½ç½®çš„é€»è¾‘æå–ä¸ºå‡½æ•°

oldï¼š

```tsx
// éå†æ£‹ç›˜ä¸Šçš„æ¯ä¸€ä¸ªç©ºä½
for (let row = 0; row < rowMax; row++) {
    for (let col = 0; col < colMax; col++) {
        if (!squares[row][col]) {
            squares[row][col] = flag; // å°è¯•åœ¨è¯¥ç©ºä½ä¸Šæ”¾ç½®å½“å‰ç©å®¶çš„æ£‹å­
            // é€’å½’è°ƒç”¨minimaxï¼Œåˆ‡æ¢ç©å®¶è§’è‰²ï¼ˆå› ä¸ºåˆ°å¯¹æ‰‹ç©å®¶ä¸‹æ£‹äº†ï¼‰
            best = Math.max(best, minimax(squares, false, flag, opponentFlag, successNeedNum, { posY: row, posX: col }));
            squares[row][col] = null; // å›é€€ï¼ŒæŠŠè¯¥ä½ç½®ä¸Šçš„æ£‹å­æ¢å¤ä¸ºç©º
        }
    }
}
```

newï¼š

```tsx

/**
 * è·å–æ£‹ç›˜ä¸­çš„ç©ºä½
 * @param squares æ£‹ç›˜äºŒç»´åˆ—è¡¨
 */
const getEmptyPos = (squares: SquaresList): PosInfo[] => {
    const list: PosInfo[] = [];
    const rowMax = squares.length; // æ£‹ç›˜çš„è¡Œæ•°
    const colMax = squares[0].length; // æ£‹ç›˜çš„åˆ—æ•°
    for (let row = 0; row < rowMax; row++) {
        for (let col = 0; col < colMax; col++) {
            if (!squares[row][col]) {
                list.push({ posY: row, posX: col });
            }
        }
    }
    return list;
};

```

#### ä¼˜åŒ–æ£‹ç›˜æ ¼å­çš„æ¸²æŸ“ï¼šæå–ä¸ºç»„ä»¶å¹¶è¿›è¡Œç¼“å­˜ä¼˜åŒ–

oldï¼š

```tsx
    render () {
        const { latticeWidth, squares, onLinePointPosList } = this.props;
        return (
            <div className="board-container">
                {/* éå†äºŒç»´åˆ—è¡¨ï¼Œæ¸²æŸ“æ¯ä¸ªæ ¼å­ */}
                {squares.map((list, row) => {
                    return (<div key={row} className='board-row'>
                        {list.map(((value, col) => (<div
                            // ä¸ºèƒœåˆ©æ—¶åœ¨ä¸€æ¡çº¿ä¸Šçš„ç‚¹æ·»åŠ é«˜äº®æ ·å¼
                            className={classNames('square', { 'active-square': onLinePointPosList.some(pos => pos.posY === row && pos.posX === col) })}
                            style={{ width: latticeWidth, height: latticeWidth }  }
                            onClick={() => this.props.onPlay(row, col)}
                            key={col}
                        >
                            {value}
                        </div>)))}
                    </div>);
                })}
            </div>
        );
    }
```

newï¼š
`Checkerboard`ç»„ä»¶ä½¿ç”¨`PureComponent`è¿›è¡Œ state å’Œ props çš„æµ…æ¯”è¾ƒï¼Œæ³¨æ„ä¼ å…¥`Checkerboard`ç»„ä»¶çš„ props å¦‚æœæ˜¯å¼•ç”¨ç±»å‹åˆ™éœ€è¦è¿›è¡Œç¼“å­˜ã€‚

```tsx
    render () {
        const { squares, onLinePointPosList } = this.props;
        return (
            <div className="board-container">
                {/* éå†äºŒç»´åˆ—è¡¨ï¼Œæ¸²æŸ“æ¯ä¸ªæ ¼å­ */}
                {squares.map((list, row) => {
                    return (<div key={row} className='board-row'>
                        {list.map(((value, col) => (<Checkerboard
                            key={col}
                            isActive={onLinePointPosList.some(pos => pos.posY === row && pos.posX === col)}
                            posY={row}
                            posX={col}
                            flag={value}
                            onClickCheckerboard={ this.handleClickCheckerboard }
                        ></Checkerboard>)))}
                    </div>);
                })}
            </div>
        );
    }
```

## è¦ç‚¹å®ç°è®°å½•

### è®¡ç®—æ£‹å±€çš„èƒœåˆ©è€…

```tsx
/** ä¸€ä¸ªç‚¹çš„ä½ç½®è®°å½•ï¼ŒposYï¼šçºµåæ ‡ï¼ˆè¡Œï¼‰ï¼ŒposXï¼šæ¨ªåæ ‡ï¼ˆåˆ—ï¼‰ */
export type PosInfo = {posY:number, posX:number}
/** æ£‹ç›˜äºŒç»´åˆ—è¡¨ï¼Œå…¶ä¸­ï¼šå­—ç¬¦ä¸²è¡¨ç¤ºæ£‹å­ï¼Œæˆ–nullè¡¨ç¤ºç©º */
export type SquaresList = ((string | null)[])[]
```

```tsx
import { SquaresList } from '../components/Board/Board.type';
import { PosInfo } from './index.type';

/**
 * è®¡ç®—èƒœåˆ©è€…ã€‚
 * æ£€æŸ¥åœ¨posYå’ŒposXä½ç½®çš„æ£‹å­å‘¨å›´çš„æ‰€æœ‰å¯èƒ½æ–¹å‘ä¸Šæ˜¯å¦æœ‰è¿ç»­çš„successNeedNumä¸ªç›¸åŒçš„æ£‹å­åœ¨åŒä¸€ç›´çº¿ä¸Šã€‚
 * è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å››ä¸ªæ–¹å‘ï¼šæ°´å¹³ã€å‚ç›´ã€æ­£å¯¹è§’çº¿å’Œåå¯¹è§’çº¿ã€‚
 *
 * @param squares æ£‹ç›˜äºŒç»´æ•°ç»„
 * @param successNeedNum è¦æ±‚è·èƒœæ—¶åœ¨ä¸€æ¡çº¿ä¸Šçš„æœ€å°‘æ£‹å­æ•°é‡
 * @param posX æ£‹å­æ¨ªåæ ‡(åˆ—ä½ç½®)
 * @param posY æ£‹å­çºµåæ ‡(è¡Œä½ç½®)
 * @returns è·èƒœè€…çš„æ ‡è®°ï¼ˆå­—ç¬¦ä¸²ï¼‰å’Œåœ¨åŒä¸€æ¡çº¿ä¸Šçš„ç‚¹çš„åæ ‡
 */
export const calculateWinner = (squares: SquaresList, successNeedNum: number, posX: number, posY: number) => {
    /** ä¿å­˜æœ‰ç©å®¶èƒœåˆ©æ—¶ï¼Œåœ¨åŒä¸€æ¡çº¿ä¸Šçš„ç‚¹çš„åæ ‡ */
    let onLinePointPosList:PosInfo[] = [];
    /**
     * è¿™ä¸ªå‡½æ•°ä¼šæ£€æŸ¥åœ¨ç»™å®šçš„æ–¹å‘ä¸Šæ˜¯å¦æœ‰è¿ç»­çš„successNeedNumä¸ªç›¸åŒæ£‹å­ã€‚
     * @param dx åœ¨xè½´ä¸Šçš„ç§»åŠ¨æ­¥é•¿
     * @param dy åœ¨yè½´ä¸Šçš„ç§»åŠ¨æ­¥é•¿
     * @returns
     */
    const checkDirection = (dx: number, dy: number) => {
        let currentCount = 1; // å½“å‰è¿ç»­çš„æ£‹å­æ•°é‡
        onLinePointPosList.push({ posY, posX });

        // å‘å‰æ£€æŸ¥
        /** ç§»åŠ¨åçš„æ¨ªåæ ‡ */
        let newX = posX + dx;
        /** ç§»åŠ¨åçš„çºµåæ ‡ */
        let newY = posY + dy;
        while (newX >= 0 && newX < squares[0].length && newY >= 0 && newY < squares.length) { // ç¡®ä¿åœ¨æ£‹ç›˜å†…
            // æ£‹å­ç›¸åŒ
            if (squares[newY][newX] === squares[posY][posX]) {
                onLinePointPosList.push({ posY: newY, posX: newX });
                newX += dx;
                newY += dy;
                currentCount++;
            } else {
                // æ£‹å­ä¸è¿ç»­äº†ï¼Œç›´æ¥ç»“æŸ
                break;
            }
        }

        // å‘åæ£€æŸ¥
        newX = posX - dx;
        newY = posY - dy;
        while (newX >= 0 && newX < squares[0].length && newY >= 0 && newY < squares.length) {
            if (squares[newY][newX] === squares[posY][posX]) {
                onLinePointPosList.push({ posY: newY, posX: newX });
                newX -= dx;
                newY -= dy;
                currentCount++;
            } else {
                break;
            }
        }

        if (currentCount >= successNeedNum) {
            return true;
        }
        onLinePointPosList = [];
        return false;
    };

    // æ£€æŸ¥æ‰€æœ‰æ–¹å‘ï¼šè°ƒç”¨checkDirectionå››æ¬¡ï¼Œåˆ†åˆ«æ£€æŸ¥æ°´å¹³ã€å‚ç›´ã€æ­£å¯¹è§’çº¿å’Œåå¯¹è§’çº¿æ–¹å‘ã€‚
    if (checkDirection(1, 0) || checkDirection(0, 1) || checkDirection(1, 1) || checkDirection(-1, 1)) {
        return {
            winner: squares[posY][posX],
            onLinePointPosList,
        };
    }
    // å¦‚æœæ²¡æœ‰è·èƒœè€…
    return {
        winner: null,
        onLinePointPosList: [],
    };
};

```

### äº•å­—æ£‹å®ç° AI ä¸‹æ£‹

åœ¨3*3çš„äºŒç»´æ•°ç»„å®ç°çš„äº•å­—æ£‹æ¸¸æˆä¸­ï¼Œå¢åŠ å’Œç©å®¶å¯¹æŠ—çš„AIï¼ˆä»…å®ç°äº•å­—æ£‹å³å¯ï¼‰ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

1. AI å¦‚æœå…ˆæ‰‹ï¼Œåˆ™éœ€è¦å°½å¯èƒ½èµ¢ï¼Œä¸èƒ½è¾“
2. AI å¦‚æœåæ‰‹ï¼Œåˆ™éœ€è¦ä¿è¯ä¸è¾“ ï¼Œå¹¶ä¸”åœ¨å¯èƒ½çš„æƒ…å†µä¸‹èµ¢

#### äº•å­—æ£‹é¡»çŸ¥

äº•å­—æ£‹é¡»çŸ¥ï¼š

- å¦‚æœéƒ½æ˜¯äº•å­—æ£‹é«˜æ‰‹ï¼Œéƒ½éµå¾ªæœ€ä¼˜ä¸‹æ£‹ç­–ç•¥ï¼Œé‚£ä¹ˆï¼š
- äº•å­—æ£‹å…ˆæ‰‹ï¼Œä¸­é—´æ ¼å­ä¸€èˆ¬æ˜¯æœ€ä½³è½å­ä½ç½®ï¼Œæœ€ä¼˜æ˜¯èµ¢ï¼Œæœ€å·®æ˜¯å¹³å±€ï¼Œä¸å¯èƒ½è¾“ã€‚
- äº•å­—æ£‹åæ‰‹ï¼Œæœ€ä¼˜æ˜¯å¹³å±€ï¼Œæœ€å·®æ˜¯è¾“ï¼Œä¸å¯èƒ½èµ¢ã€‚
- éƒ½æ˜¯é«˜æ‰‹çš„è¯ï¼Œä¸€èˆ¬éƒ½æ˜¯å¹³å±€ã€‚

#### ä¸‹æ£‹è¿‡ç¨‹æ¨¡æ‹Ÿ

##### ç©å®¶å…ˆæ‰‹ï¼ŒAI åæ‰‹

```tsx
// 1. ç©å®¶"O"æ˜¯å…ˆæ‰‹
/**
[
    [null, null, null],
    [null, 'O', null],
    [null, null, null],
]
 */

// 2. AI"X"
/**
[
    ['X', null, null],
    [null, 'O', null],
    [null, null, null],
]
 */

// 3. ç©å®¶"O"
/**
[
    ['X', null, null],
    [null, 'O', 'O'],
    [null, null, null],
]
 */

// 4. AI"X"
/**
[
    ['X', null, null],
    ['X', 'O', 'O'],
    [null, 'X', null],
]
 */

// 5. ç©å®¶"O"
/**
[
    ['X', null, null],
    ['X', 'O', 'O'],
    ['O', null, null],
]
 */

// 6. AI"X"
/**
[
    ['X', null, 'X'],
    ['X', 'O', 'O'],
    ['O', null, null],
]
 */

// 7. ç©å®¶"O"
/**
[
    ['X', 'O', 'X'],
    ['X', 'O', 'O'],
    ['O', null, null],
]
 */

// 8. AI"X"
/**
[
    ['X', 'O', 'X'],
    ['X', 'O', 'O'],
    ['O', 'X', null],
]
 */

// 9. ç©å®¶"O"
/**
[
    ['X', 'O', 'X'],
    ['X', 'O', 'O'],
    ['O', 'X', 'O'],
]
 */
```

##### AIå…ˆæ‰‹ï¼Œ ç©å®¶åæ‰‹

```tsx
// 1. AI"X"æ˜¯å…ˆæ‰‹
/**
[
    ['X', null, null],
    [null, null, null],
    [null, null, null],
]
 */

// 2. ç©å®¶"O"
/**
[
    ['X', null, null],
    [null, 'O', null],
    [null, null, null],
]
 */

// 3. AI"X"
/**
[
    ['X', 'X', null],
    [null, 'O', null],
    [null, null, null],
]
 */

// 4. ç©å®¶"O"
/**
[
    ['X', 'X', 'O'],
    [null, 'O', null],
    [null, null, null],
]
 */

// 5. AI"X"
/**
[
    ['X', 'X', 'O'],
    [null, 'O', null],
    ['X', null, null],
]
 */

// 6. ç©å®¶"O"
/**
[
    ['X', 'X', 'O'],
    ['O', 'O', null],
    ['X', null, null],
]
 */

// 7. AI"X"
/**
[
    ['X', 'X', 'O'],
    ['O', 'O', 'X'],
    ['X', null, null],
]
 */

// 8. ç©å®¶"O"
/**
[
    ['X', 'X', 'O'],
    ['O', 'O', 'X'],
    ['X', 'O', null],
]
 */

// 9. AI"X"
/**
[
    ['X', 'X', 'O'],
    ['O', 'O', 'X'],
    ['X', 'O', 'X'],
]
 */
```

#### æ±‚è§£æœ€ä¼˜ä¸‹æ£‹ä½ç½®çš„ç®—æ³•ï¼šæå°åŒ–æå¤§ç®—æ³•ï¼ˆMinimax Algorithmï¼‰

##### å¤§è‡´éª¨æ¶

```tsx

/** æ£‹ç›˜äºŒç»´åˆ—è¡¨ï¼Œå…¶ä¸­ï¼šå­—ç¬¦ä¸²è¡¨ç¤ºæ£‹å­ï¼Œæˆ–nullè¡¨ç¤ºç©º */
type SquaresList = ((string | null)[])[]

/** ä¸€ä¸ªç‚¹çš„ä½ç½®è®°å½•ï¼ŒposYï¼šçºµåæ ‡ï¼ˆè¡Œï¼‰ï¼ŒposXï¼šæ¨ªåæ ‡ï¼ˆåˆ—ï¼‰ */
export type PosInfo = {posY:number, posX:number}

/**
 * ç»™å‡ºä¸€ä¸ªæ£‹ç›˜çŠ¶æ€çš„äºŒç»´åˆ—è¡¨å’Œä¸€ä¸ªæ£‹å­æ ‡è®°ï¼Œè¿”å›æœ€ä½³çš„ä¸‹æ£‹ä½ç½®
 * @param squares æ£‹ç›˜äºŒç»´åˆ—è¡¨ï¼ˆåªæ”¯æŒæ£‹ç›˜å¤§å°ä¸º3*3ï¼‰
 * @param flag å¸Œæœ›å°½å¯èƒ½è·èƒœçš„æ£‹å­æ ‡è®°
 * @returns æœ€ä½³çš„è¯¥æ£‹å­ä¸‹æ£‹çš„ä½ç½®
 */
function calculateNextMove(squares: SquaresList, flag: string): PosInfo {

}

// 1. ç©å®¶"O"æ˜¯å…ˆæ‰‹
const squares = [
    [null, null, null],
    [null, 'O', null],
    [null, null, null],
]

// 2. AI"X" è°ƒç”¨ calculateNextMove æ–¹æ³•è®¡ç®—æœ€ä¼˜çš„ä¸‹ä¸€æ­¥æ£‹çš„ä½ç½®
const res = calculateNextMove(squares, 'X');
```

##### ç®—æ³•æ€è·¯

ä¸ºäº†å®ç°`calculateNextMove`å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨æå°åŒ–æå¤§ç®—æ³•ï¼ˆMinimax Algorithmï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ç»å…¸çš„é€’å½’ç®—æ³•ï¼Œç”¨äºä¸¤äººæ¸¸æˆï¼ˆå¦‚äº•å­—æ£‹ï¼‰ä¸­è®¡ç®—æœ€ä½³ç§»åŠ¨ã€‚è¯¥ç®—æ³•é€šè¿‡é€’å½’è®¡ç®—æ¯ä¸€ä¸ªå¯èƒ½çš„ç§»åŠ¨ï¼Œè¯„ä¼°å±€é¢ï¼Œç„¶åé€‰æ‹©æœ€ä¼˜ç­–ç•¥ã€‚
ä»¥ä¸‹æ˜¯å®ç°æ­¥éª¤ï¼š

1. **ç»ˆå±€åˆ¤æ–­å‡½æ•°**`** checkWinner  **`ï¼šåˆ¤æ–­å½“å‰æ£‹å±€æ˜¯å¦æœ‰èƒœè€…æˆ–å¹³å±€ã€‚
2. **è®¡ç®—å¾—åˆ†å‡½æ•°**`** evaluate  **`ï¼šå¦‚æœæŸæ–¹èƒœåˆ©ï¼Œåˆ™è¿”å›ä¸€ä¸ªåˆ†æ•°ã€‚
3. **æå¤§æå°é€’å½’å‡½æ•°**`** minimax  **`ï¼šé€’å½’è¯„ä¼°æ‰€æœ‰å¯èƒ½çš„ç§»åŠ¨ï¼Œé€‰æ‹©æœ€ä¼˜ç§»åŠ¨ã€‚
4. **ä¸»å‡½æ•°**`** calculateNextMove  **`ï¼šä¸ºæ£‹ç›˜ä¸Šçš„æ¯ä¸€ä¸ªç©ºä½è°ƒç”¨`**minimax**`é€’å½’å‡½æ•°ï¼Œå¹¶è¿”å›æœ€ä½³ç§»åŠ¨çš„ä½ç½®ã€‚

##### ç®—æ³•å®ç°

```tsx

/** æ£‹ç›˜äºŒç»´åˆ—è¡¨ï¼Œå…¶ä¸­ï¼šå­—ç¬¦ä¸²è¡¨ç¤ºæ£‹å­ï¼Œæˆ–nullè¡¨ç¤ºç©º */
type SquaresList = ((string | null)[])[]

/** ä¸€ä¸ªç‚¹çš„ä½ç½®è®°å½•ï¼ŒposYï¼šçºµåæ ‡ï¼ˆè¡Œï¼‰ï¼ŒposXï¼šæ¨ªåæ ‡ï¼ˆåˆ—ï¼‰ */
export type PosInfo = { posY: number, posX: number }

/**
 * æ£€æŸ¥æ£‹ç›˜æ˜¯å¦æœ‰èƒœè€…
 * @param squares æ£‹ç›˜äºŒç»´åˆ—è¡¨
 * @returns å¦‚æœæœ‰èƒœè€…åˆ™è¿”å›èƒœè€…çš„æ£‹å­æ ‡è®°ï¼Œå¦åˆ™è¿”å›null
 */
function checkWinner(squares: SquaresList): string | null {
    const lines = [
        [[0, 0], [0, 1], [0, 2]],// ç¬¬ä¸€è¡Œ
        [[1, 0], [1, 1], [1, 2]],// ç¬¬äºŒè¡Œ
        [[2, 0], [2, 1], [2, 2]],// ç¬¬ä¸‰è¡Œ
        [[0, 0], [1, 0], [2, 0]],// ç¬¬ä¸€åˆ—
        [[0, 1], [1, 1], [2, 1]],// ç¬¬äºŒåˆ—
        [[0, 2], [1, 2], [2, 2]],// ç¬¬ä¸‰åˆ—
        [[0, 0], [1, 1], [2, 2]],// å¯¹è§’çº¿
        [[0, 2], [1, 1], [2, 0]],// å¯¹è§’çº¿
    ];
    // æ£€æŸ¥æ‰€æœ‰å¯èƒ½è¿æˆä¸€æ¡çº¿çš„ä½ç½®ç»„ï¼Œæ˜¯å¦è¿æˆäº†ä¸€æ¡çº¿
    for (let i = 0; i < lines.length; i++) {
        const [[a, b], [c, d], [e, f]] = lines[i];
        if (squares[a][b] && squares[a][b] === squares[c][d] && squares[a][b] === squares[e][f]) {
            return squares[a][b];
        }
    }
    return null;
}

/**
 * è¯„ä¼°å½“å‰æ£‹ç›˜çŠ¶æ€çš„å¾—åˆ†
 * @param squares æ£‹ç›˜äºŒç»´åˆ—è¡¨
 * @param flag å¸Œæœ›å°½å¯èƒ½è·èƒœçš„æ£‹å­æ ‡è®°
 * @returns å¦‚æœå½“å‰æ£‹å­èƒœåˆ©è¿”å›10åˆ†ï¼Œå¯¹æ–¹èƒœåˆ©è¿”å›-10åˆ†ï¼Œå¹³å±€è¿”å›0åˆ†
 */
function evaluate(squares: SquaresList, flag: string): number {
    const winner = checkWinner(squares);
    if (winner === flag) {
        return 10;
    } else if (winner && winner !== flag) {
        return -10;
    }
    return 0;
}

/**
 * æå¤§æå°ç®—æ³•é€’å½’å‡½æ•°
 * @param squares æ£‹ç›˜äºŒç»´åˆ—è¡¨
 * @param depth å½“å‰é€’å½’æ·±åº¦
 * @param isMaximizing æ˜¯å¦ä¸ºæå¤§åŒ–æ–¹
 * @param flag å½“å‰æ£‹å­æ ‡è®°
 * @param opponentFlag å¯¹æ–¹æ£‹å­æ ‡è®°
 * @returns å½“å‰æ£‹ç›˜çŠ¶æ€çš„æœ€ä½³å¾—åˆ†
 */
function minimax(squares: SquaresList, depth: number, isMaximizing: boolean, flag: string, opponentFlag: string): number {
    // è¯„ä¼°ä¸Šæ¬¡æ”¾ç½®æ£‹å­çš„ä½ç½®çš„åˆ†æ•°
    const score = evaluate(squares, flag);
    if (score === 10 || score === -10) {
        return score;
    }

    // æ£‹ç›˜å·²ç»æ»¡äº†ï¼Œä¸éœ€è¦å†éå†æ£‹ç›˜ç©ºä½ä¸‹æ£‹äº†ï¼Œå¦åˆ™ç»§ç»­éå†æ£‹ç›˜ç©ºä½è¿›è¡Œä¸‹æ£‹ï¼Œç›´åˆ°ï¼šæœ‰ç©å®¶è·èƒœæˆ–è€…æ£‹ç›˜æ»¡äº†
    if (squares.flat().every(cell => cell)) {
        return 0;
    }

    if (isMaximizing) {
        let best = -Infinity;
        // éå†æ£‹ç›˜ä¸Šçš„æ¯ä¸€ä¸ªç©ºä½
        for (let i = 0; i < 3; i++) {
            for (let j = 0; j < 3; j++) {
                if (!squares[i][j]) {
                    squares[i][j] = flag; // å°è¯•åœ¨è¯¥ç©ºä½ä¸Šæ”¾ç½®å½“å‰ç©å®¶çš„æ£‹å­
                    // é€’å½’è°ƒç”¨minimaxï¼Œåˆ‡æ¢ç©å®¶è§’è‰²ï¼ˆå› ä¸ºåˆ°å¯¹æ‰‹ç©å®¶ä¸‹æ£‹äº†ï¼‰
                    best = Math.max(best, minimax(squares, depth + 1, false, flag, opponentFlag));
                    squares[i][j] = null; // å›é€€
                }
            }
        }
        return best;
    } else {
        let best = Infinity;
        for (let i = 0; i < 3; i++) {
            for (let j = 0; j < 3; j++) {
                if (!squares[i][j]) {
                    squares[i][j] = opponentFlag; // å°è¯•åœ¨è¯¥ç©ºä½ä¸Šæ”¾ç½®å¯¹æ‰‹ç©å®¶çš„æ£‹å­
                    best = Math.min(best, minimax(squares, depth + 1, true, flag, opponentFlag));
                    squares[i][j] = null;
                }
            }
        }
        return best;
    }
}

/**
 * è®¡ç®—æœ€ä½³ä¸‹æ£‹ä½ç½®
 * @param squares æ£‹ç›˜äºŒç»´åˆ—è¡¨
 * @param flag å¸Œæœ›å°½å¯èƒ½è·èƒœçš„æ£‹å­æ ‡è®°ï¼ˆå½“å‰éœ€è¦ä¸‹æ£‹çš„æ£‹å­æ ‡è®°ï¼‰
 * @returns æœ€ä½³çš„è¯¥æ£‹å­ä¸‹æ£‹çš„ä½ç½®
 */
function calculateNextMove(squares: SquaresList, flag: string): PosInfo {
    squares = JSON.parse(JSON.stringify(squares))
    let bestVal = -Infinity;
    let bestMove: PosInfo = { posY: -1, posX: -1 };
    const opponentFlag = flag === 'X' ? 'O' : 'X';
    // éå†æ£‹ç›˜ä¸Šçš„æ¯ä¸€ä¸ªç©ºä½
    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            if (!squares[i][j]) {
                squares[i][j] = flag; // å°è¯•åœ¨è¯¥ç©ºä½ä¸Šæ”¾ç½®å½“å‰ç©å®¶çš„æ£‹å­
                let moveVal = minimax(squares, 0, false, flag, opponentFlag);
                squares[i][j] = null; // å›é€€ï¼ŒæŠŠè¯¥ä½ç½®ä¸Šçš„æ£‹å­æ¢å¤ä¸ºç©º
                // å¦‚æœå½“å‰ä½ç½®çš„åˆ†æ•°å¤§äºæœ€ä½³åˆ†æ•°ï¼Œåˆ™æ›´æ–°æœ€ä½³åˆ†æ•°å’Œæœ€ä½³èµ°æ³•ä½ç½®
                // å› ä¸ºæ˜¯å½“å‰ç©å®¶ï¼ˆflagï¼‰å¸Œæœ›å°½å¯èƒ½è·èƒœï¼Œè€Œåœ¨è¯„ä¼°å‡½æ•°ä¸­ï¼Œå½“å‰ç©å®¶è·èƒœæ˜¯+10åˆ†ï¼Œæ‰€ä»¥åˆ†æ•°è¶Šå¤§è¶Šå¥½
                if (moveVal > bestVal) {
                    bestMove = { posY: i, posX: j };
                    bestVal = moveVal;
                }
            }
        }
    }

    return bestMove;
}


// 1. ç©å®¶"O"æ˜¯å…ˆæ‰‹
const squares = [
    [null, null, null],
    [null, 'O', null],
    [null, null, null],
]

// 2. AI"X" è°ƒç”¨ calculateNextMove æ–¹æ³•è®¡ç®—æœ€ä¼˜çš„ä¸‹ä¸€æ­¥æ£‹çš„ä½ç½®
const res = calculateNextMove(squares, 'X');
console.log(res);
// { posY: 0, posX: 0 }

```

##### å›¾è§£ç®—æ³•

```tsx

// 1. AI"O"æ˜¯å…ˆæ‰‹
// çœç•¥ã€‚ã€‚ã€‚
// 6. ç©å®¶"X"
/**
[
    ['O', 'X', 'O'],
    ['X', null, null],
    ['X', 'O', null],
]
 */

const squares = [
    ['O', 'X', 'O'],
    ['X', null, null],
    ['X', 'O', null],
]

// 7. AI"O" è°ƒç”¨ calculateNextMove æ–¹æ³•è®¡ç®—æœ€ä¼˜çš„ä¸‹ä¸€æ­¥æ£‹çš„ä½ç½®
const res = calculateNextMove(squares, 'O');
console.log(res);

```

![image.png](https://cdn.nlark.com/yuque/0/2024/png/34576819/1720868819659-e7e7926b-3a0f-4e3d-99b0-07ddc42c9a2a.png#averageHue=%23ecebeb&clientId=ube135a04-c821-4&from=paste&id=eJxE8&originHeight=1388&originWidth=2016&originalType=url&ratio=1&rotation=0&showTitle=false&size=253387&status=done&style=none&taskId=u12b79dc0-4fd8-418a-847b-3c92599f300&title=)
![](https://cdn.nlark.com/yuque/0/2024/jpeg/34576819/1720881483376-1520fa23-4673-49b6-aa70-f69da73b532b.jpeg)

##### å¤æ‚åº¦åˆ†æ

æå¤§æå°ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åˆ†æä¸»è¦å–å†³äºé€’å½’è°ƒç”¨çš„æ¬¡æ•°å’Œæ¯æ¬¡è°ƒç”¨ä¸­æ‰€è¿›è¡Œçš„æ“ä½œã€‚å¯¹äºä¸€ä¸ª3x3çš„äº•å­—æ£‹ï¼ˆTic-Tac-Toeï¼‰æ¸¸æˆï¼Œæ—¶é—´å¤æ‚åº¦å¦‚ä¸‹ï¼š

1. **é€’å½’æ ‘çš„æ·±åº¦**ï¼šå¯¹äºä¸€ä¸ª3x3çš„äº•å­—æ£‹ï¼Œæœ€å¤šæœ‰9ä¸ªç©ºä½ï¼Œå› æ­¤é€’å½’æ ‘çš„æœ€å¤§æ·±åº¦ä¸º9ã€‚
2. **æ¯å±‚é€’å½’çš„åˆ†æ”¯æ•°é‡**ï¼šåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªç©ºä½éƒ½å¯èƒ½æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç§»åŠ¨ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸€å±‚ï¼Œå¯èƒ½æœ‰æœ€å¤š9ä¸ªã€8ä¸ªã€7ä¸ªâ€¦â€¦ç›´åˆ°1ä¸ªå¯èƒ½çš„åˆ†æ”¯ã€‚

ç»¼åˆè€ƒè™‘ï¼Œè¿™å½¢æˆäº†ä¸€ä¸ªé€’å½’æ ‘ï¼Œå…¶èŠ‚ç‚¹æ•°å¤§è‡´æ˜¯9!ï¼ˆå³9çš„é˜¶ä¹˜ï¼‰ï¼Œå› ä¸ºæ¯ä¸€å±‚çš„åˆ†æ”¯æ•°é‡åˆ†åˆ«æ˜¯9ã€8ã€7â€¦â€¦1ã€‚
å› æ­¤ï¼Œæå¤§æå°ç®—æ³•åœ¨äº•å­—æ£‹ä¸­çš„æœ€åæ—¶é—´å¤æ‚åº¦ä¸ºO(9!)ã€‚
ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£ï¼Œè®©æˆ‘ä»¬ç®€åŒ–ä¸€äº›ï¼š

- ç¬¬ä¸€å±‚æœ‰9ä¸ªé€‰æ‹©ã€‚
- ç¬¬äºŒå±‚æœ‰8ä¸ªé€‰æ‹©ã€‚
- ç¬¬ä¸‰å±‚æœ‰7ä¸ªé€‰æ‹©ã€‚
- â€¦

è¿™æ„å‘³ç€æ€»çš„èŠ‚ç‚¹æ•°æ˜¯ï¼š
$9 \times 8 \times 7 \times ... \times 1 = 9! = 362,880$
è™½ç„¶è¿™ä¸ªæ•°ç›®çœ‹èµ·æ¥å¾ˆå¤§ï¼Œä½†å¯¹äºç°ä»£è®¡ç®—æœºæ¥è¯´ï¼Œè¿™ä¸ªé‡çº§æ˜¯å¯ä»¥å¤„ç†çš„ã€‚å®é™…ä¸Šï¼Œç”±äºäº•å­—æ£‹çš„ç®€å•æ€§å’Œæœ‰é™çš„å±€é¢ï¼Œè®¸å¤šåˆ†æ”¯åœ¨è¾ƒæ—©çš„é˜¶æ®µå°±ä¼šè¢«å‰ªæï¼ˆä½¿ç”¨Î±-Î²å‰ªææŠ€æœ¯ï¼‰ï¼Œå®é™…è¿è¡Œæ—¶é—´ä¼šæ›´çŸ­ã€‚

#### å‚è€ƒ

[Minimaxåšå¼ˆç®—æ³•è®¾è®¡äº•å­—æ£‹AI(Golang) - RedJACK~ - åšå®¢å›­](https://www.cnblogs.com/jackonessalad/articles/16358473.html)
[â€“ æ€æºåšå®¢](https://www.siyuanblog.cn/archives/minmax)
[ç²¾é€šäº•å­—æ£‹ï¼šç­–ç•¥ã€è§„åˆ™å’Œè¯´æ˜](https://tictactoefree.com/zh/guize)
[åœ¨çº¿ç©äº•å­—æ£‹ã€‚1äººæˆ–2äººçš„æ¸¸æˆã€‚](https://tictactoefree.com/zh/)
